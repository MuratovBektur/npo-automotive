# npo_automotive

## Предварительные требования

### Установите docker и docker compose

### Заполните файлы окружение по аналогии с example.env для соответствующего окружение (prod.env, dev.env, local.env) (там всего лишь 5 полей)

## Запуск 

```bash
./restart-local.sh # local dev mode (port - 7000)
```

<br/>

```bash
./restart-dev.sh # dev mode (port - 7000)
```

<br/>

```bash
./restart.sh # prod mode (port - 80)
```

Frontend: http://localhost:{порт, который указан в local.env}

<br/>

Backend: http://localhost:{порт, который указан в local.env}/api

### Чтобы запустить миграцию в локальной режиме:


1) Перейдите в терминале в папку   сервера:

```bash
cd server
```

2) Пропишете команду для сервера:

```bash
./cli.sh npx ts-node node_modules/typeorm/cli.js migration:run -d src/data-source.ts 
```

## Инструменты разработки

### Для облегчения работы с Nest (только в dev режиме) в docker контейнере:

1) Перейдите в терминале в папку   сервера:

```bash
cd server
```

2) Пропишете нужную команду для сервера:

```bash
./cli.sh your_command # например ./cli.sh nest g res user
```

### Также для облегчения работы с Vue (только в dev режиме) в docker контейнере:

1) Перейдите в терминале в папку клиента:

```bash
cd client
```

2) Пропишете нужную команду для клиента:

```bash
./cli.sh your_command # например ./cli.sh npm i axios
```


### Чтобы попасть в админку в бд (только в local режиме):

1) зайдите на http://localhost:{порт, который указан в local.env}/dba/

2) заполните форму для создании соединении с бд в соотвествием с тем что указана в файле окружении (local.env), но где поле Server укажите bd (по названию сервиса в docker-compose.local.yml)







### Результаты теста:

#### Без оптимизации

- Время выполнения на 100 запросов с нулевой задержкой (3 раз):

1) 20444 мс 
2) 19654 мс  
3) 20985 мс 


- Время выполнения на 100 запросов с задержкой 10мс (3 раз) :

1) 20085 мс 
2) 20581 мс  
3) 20147 мс 


#### Оптимизация запросов с помощью кэширование в nginx конфиге (ссылка на файл с конфигом result/nginx_with_cache.conf)


- Время выполнения на 100 запросов с нулевой задержкой (3 раз)

1) 3703 мс 
2) 3283 мс 
3) 3300 мс 

- Время выполнения на 100 запросов с задержкой 10мс (3 раз)

1) 3695 мс 
2) 3666 мс 
3) 3837 мс 

#### Оптимизация запросов с помощью кэширование в nest  контроллере (ссылка на файл с конфигом result/items.controller.ts)


- Время выполнения на 100 запросов с нулевой задержкой (3 раз)

1) 10474 мс 
2) 10510 мс 
3) 10571 мс 

- Время выполнения на 100 запросов с задержкой 10мс (3 раз)

1) 10889 мс 
2) 10735 мс 
3) 10705 мс 

#### Оптимизация запросов с помощью увеличение пулов соединения c PostgreSQL (ссылка на файл с конфигом result/items.controller.ts)


- Время выполнения на 100 запросов с нулевой задержкой (3 раз)

1) 18858 мс 
2) 18963 мс 
3) 10571 мс 

- Время выполнения на 100 запросов с задержкой 10мс (3 раз)

1) 20121 мс 
2) 18975 мс 
3) 19313 мс 
