FROM node:22

WORKDIR /app

COPY package.json ./

RUN npm install

COPY . .

CMD [ -d "node_modules" ] && npm run dev || npm install --frozen-lockfile && npm run dev